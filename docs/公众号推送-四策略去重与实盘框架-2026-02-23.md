# A股日筛四策略升级：去重口径统一后，我们如何看结果？

这次我们把 A 股日线选股系统做了一个关键升级：

- 四个策略统一为“一股一行”的输出口径（按 `symbol` 唯一）
- 趋势与反转只保留阳性结果
- 打分与价值保持 TopN 排序，同时确保同一股票不重复占位

这一步的意义是：日常复盘更清楚，回测口径更稳定，策略之间可对比性更强。

---

## 一、系统现在有哪些策略？

目前系统包含四套策略：

1. `trend`（趋势策略）
2. `reversal`（反转策略）
3. `score`（趋势打分策略）
4. `value`（价值策略）

并且全部由统一入口执行：`src/main.py`。

---

## 二、每个策略主要逻辑（白话版）

### 1) Trend：顺势优先，找在轨道里的强票

先看市场是否允许做多（HS300 趋势），再做行业强度筛选，最后在个股层面看趋势结构是否成立。当前输出只保留 `final_signal=true` 的阳性标的。

### 2) Reversal：寻找“从弱转强”的结构拐点

通过反转 5.0 条件组合（A/B/D/AA/AB）判断是否具备反转特征。当前输出只保留 `reversal_signal=true` 的阳性标的。

### 3) Score：给趋势候选打分排序

围绕趋势、结构、量能、强度、回踩五维打分，并叠加风险扣分，输出 TopN。重点看 `score_total`、`risk_flags`、`score_reason_top3`。

### 4) Value：价值筛选 + 风险约束

行业白名单 + 财务过滤 + 价值综合分（PE/PB/ROE/股息等）。
对缺失字段采用“保守降级，不放水”策略，并显式打标：`degrade_level`、`missing_fields`、`replacement_tags`。

---

## 三、为什么要做“去重”？

过去出现过同一股票在结果里重复多次的情况，核心原因是：

- 同一只股票可能映射到多个行业标签
- 在 one-to-many 合并后，如果不控制，会出现重复行
- 重复行会挤占 TopN 名额，干扰真实排序

因此这次统一改成：

- 输出阶段按 `symbol` 去重（一股一行）
- `score/value` 在排序后先去重再取 TopN
- `reversal` 在关键链路增加唯一化和合并校验，避免重复行放大

这样既保留了信息完整性（通过 `industry_tags` 聚合），又保证了统计口径稳定。

---

## 四、今天实跑结果（2026-02-23）

按当前市场数据与配置，四策略当日输出为：

- `trend`: 9 只（阳性、唯一）
- `reversal`: 3 只（阳性、唯一）
- `score`: 30 只（Top30、唯一）
- `value`: 5 只（TopN 内、唯一）

说明：数量下降并不代表策略变差，更多是把“重复计数”清理后，回到“唯一股票”的真实口径。

---

## 五、日常看盘建议：先看哪几列？

- `trend`：`symbol/name/industry/final_signal`
- `reversal`：`symbol/name/reversal_signal/reversal_rps50`
- `score`：`score_total/risk_flags/score_reason_top3`
- `value`：`value_score_total/degrade_level/replacement_tags`

一句话：

- 找信号：看 trend + reversal
- 做排序：看 score
- 控风险和估值：看 value

---

## 六、结语

这次升级的核心不是“多出多少票”，而是把策略输出从“可运行”提升到“可解释、可比较、可复盘”。

后续我们会继续围绕两件事优化：

1. 在稳定口径下提升命中质量
2. 在不放水前提下提升价值策略覆盖率

> 以上内容仅用于策略研究与工程记录，不构成投资建议。
